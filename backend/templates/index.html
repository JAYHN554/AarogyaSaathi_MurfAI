<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Voice Chat with LLM</title>
</head>

<body>
    <h1>ðŸŽ¤ Talk to AI (Hindi)</h1>
    <button onclick="startListening()">Start Talking</button>
    <p><strong>You:</strong> <span id="userText"></span></p>
    <p><strong>AI:</strong> <span id="aiText"></span></p>
    <audio id="aiAudio" controls></audio>

    <script>
        function startListening() {
            const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
            recognition.lang = "hi-IN";
            recognition.interimResults = false;
            recognition.maxAlternatives = 1;

            recognition.onresult = async (event) => {
                const text = event.results[0][0].transcript;
                document.getElementById("userText").textContent = text;

                const response = await fetch("/chat", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ text })
                });

                const data = await response.json();
                document.getElementById("aiText").textContent = data.response;
                document.getElementById("aiAudio").src = data.audio_url;
                document.getElementById("aiAudio").play();
            };

            recognition.onerror = (e) => alert("Speech error: " + e.error);
            recognition.start();
        }
    </script>
</body>

</html>